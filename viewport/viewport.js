!function(t,o){"function"==typeof define&&define.amd?define(["exports"],o):o("undefined"!=typeof exports?exports:t.viewport={})}(this,function(t){var o=[],e=40,r="viewport",l="EventListener",i="add"+l,f="remove"+l,n="getBoundingClientRect",s="top",p="bottom",c="left",h="right",a="Top",d="Left",g="Location",m="Start",v="End",u="Scroll",b="Target",w="scroll",y="resize",L="length",x=window,S=document,T=null,E=Math,H=E.min,N=E.max,W=E.abs,k=function(){var t,e,r,l,i,f,s;for(t=0;t<o.length;t++)for(r=o[t],f=r.r[n](),i={top:r.r.scrollTop,left:r.r.scrollLeft},r.r.rect={left:f.left,top:f.top,right:f.right,bottom:f.bottom,width:f.right-f.left,height:f.bottom-f.top,scrollHeight:r.r.scrollHeight,scrollWidth:r.r.scrollWidth},e=0;e<r.s.length;e++)l=r.s[e],s=l[n](),l.rect={left:s.left-f.left+i.left,top:s.top-f.top+i.top,right:s.right-f.left+i.left,bottom:s.bottom-f.top+i.top,width:s.right-s.left,height:s.bottom-s.top}},B=function(){for(var t,l,n,E,B,C,z,D,M,R=0,j=T;R<o[L];)B=o[R].r.vpl,o[R++].r[f](w,B,0),x[f](y,B,0);for(o=[],M=S.getElementsByClassName("section"),R=0;R<M[L];){for(z=C=M[R++];;){if(n=t=0,l=z==S.body,!l)for(E=z.className.split(" ");t<E[L];)if(E[t++]==r){n=1;break}if(l||n)break;z=z.parentNode}for(t=0;t<o[L];t++)o[t].v==z&&(j=o[t]);j||(D=z.scroller||z,j={v:z,r:D,s:[]},D.vpl=function(t){return function(){for(var o=t.r,l=o.rect,i=l[s],f=l[c],n=l[p],y=l[h],x=(n+i)/2,S=(f+y)/2,E=l.scrollHeight-l.height,k=l.scrollWidth-l.width,B=E?o[w+a]/E:0,C=k?o[w+d]/k:0,z=i+(n-i)*B,D=f+(y-f)*C,M={top:o.scrollTop,left:o.scrollLeft},R=T,j=T,q=0;q<t.s[L];){var A=t.s[q++],F=A.rect,G=F[s]-M.top,I=F[c]-M.left,J=F[p]-M.top,K=F[h]-M.left,O=J-G,P=K-I,Q=i-G,U=f-I,V=(D-I)/P,X=(z-G)/O,Y=N(0,W(X-.5)-.5),Z=N(0,W(V-.5)-.5),$=Y*Y+Z*Z,_=-Q-e,tt=(J+G)/2-x,ot=-U-e,et=(I+K)/2-S;A[r+a+m]=Q/O,A[r+a+v]=(n-G)/O,A[r+d+m]=U/P,A[r+d+v]=(y-I)/P,A[r+a+g]=X,A[r+d+g]=V,A[r+u+a+b]=N(0,H(E,o[w+a]+H(_,tt))),A[r+u+d+b]=N(0,H(k,o[w+d]+H(ot,et))),(j===T||j>$)&&(j=$,R=A)}t.v.currentSection=R}}(j),D[i](w,D.vpl,0),x[i](y,D.vpl,0),o.push(j)),j.s.push(C)}for(k(),x[i](y,k,0),R=0;R<o[L];)o[R++].r.vpl()};"complete"==S.readyState?B():x[i]("load",B,0),t.reset=B,t.updateDimensions=k});